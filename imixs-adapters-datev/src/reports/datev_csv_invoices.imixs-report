<?xml version="1.0" encoding="UTF-8" standalone="yes"?><document xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><item name="attributes"><value xsi:type="xmlItem"><value xsi:type="xs:string">$uniqueid</value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value></value><value xsi:type="xmlItem"><value xsi:type="xs:string">$modified</value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value></value><value xsi:type="xmlItem"><value xsi:type="xs:string">$workflowgroup</value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value></value><value xsi:type="xmlItem"><value xsi:type="xs:string">$processid</value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value></value><value xsi:type="xmlItem"><value xsi:type="xs:string">_subject</value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value></value><value xsi:type="xmlItem"><value xsi:type="xs:string">_invoicenumber</value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value></value><value xsi:type="xmlItem"><value xsi:type="xs:string">_invoicedate</value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value></value><value xsi:type="xmlItem"><value xsi:type="xs:string">_amount_brutto</value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value></value><value xsi:type="xmlItem"><value xsi:type="xs:string">_kreditor_konto</value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value></value><value xsi:type="xmlItem"><value xsi:type="xs:string">_currency</value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value></value><value xsi:type="xmlItem"><value xsi:type="xs:string">_invoicedate</value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value></value><value xsi:type="xmlItem"><value xsi:type="xs:string">_accountingdate</value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value></value><value xsi:type="xmlItem"><value xsi:type="xs:string">_datev_client_id</value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value></value><value xsi:type="xmlItem"><value xsi:type="xs:string">_datev_fiscal_start</value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value></value><value xsi:type="xmlItem"><value xsi:type="xs:string">_costcentre1</value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value></value><value xsi:type="xmlItem"><value xsi:type="xs:string">_childitems</value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value></value><value xsi:type="xmlItem"><value xsi:type="xs:string">_description</value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value></value><value xsi:type="xmlItem"><value xsi:type="xs:string">$file</value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value></value><value xsi:type="xmlItem"><value xsi:type="xs:string">$snapshotid</value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value></value><value xsi:type="xmlItem"><value xsi:type="xs:string">_datev_sachkontennummernlaenge</value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value></value><value xsi:type="xmlItem"><value xsi:type="xs:string">_datev_description</value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value></value><value xsi:type="xmlItem"><value xsi:type="xs:string">$uniqueidref</value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value></value><value xsi:type="xmlItem"><value xsi:type="xs:string">_datev_consultant_id</value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value><value xsi:type="xs:string"></value></value></item><item name="contenttype"><value xsi:type="xs:string"></value></item><item name="encoding"><value xsi:type="xs:string">UTF-8</value></item><item name="txtdescription"><value xsi:type="xs:string">DATEV export executed by teh DatevScheduler. See the XSL definition for details.   </value></item><item name="txtname"><value xsi:type="xs:string">datev_csv_invoices</value></item><item name="txtquery"><value xsi:type="xs:string"></value></item><item name="xsl"><value xsi:type="xs:string">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;&lt;xsl:stylesheet	xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="2.0"&gt;		&lt;xsl:output method="text" indent="no" byte-order-mark="yes" encoding="UTF-8" omit-xml-declaration="yes" /&gt;	&lt;xsl:strip-space elements="*" /&gt;	&lt;xsl:template match="/"&gt;	&lt;xsl:apply-templates			select="/data/document[normalize-space(item[@name = '$workflowgroup']/value) = 'DATEV-Export']" /&gt;		&lt;xsl:apply-templates		select="/data/document[normalize-space(item[@name = '$workflowgroup']/value) != 'DATEV-Export']" /&gt;	&lt;/xsl:template&gt;	&lt;!-- This template builds datev header info --&gt;	&lt;xsl:template		match="/data/document[normalize-space(item[@name = '$workflowgroup']/value) = 'DATEV-Export']"&gt;		&lt;xsl:variable name="date" select="item[@name='$modified']/value"/&gt;		&lt;xsl:variable name="stapelstart" select="item[@name='_stapelzeitraum_start']/value"/&gt;		&lt;xsl:variable name="stapelende" select="item[@name='_stapelzeitraum_ende']/value"/&gt;		&lt;xsl:variable name="fiscalstart" select="item[@name='_datev_fiscal_start']/value"/&gt;			&lt;!-- Header --&gt;&lt;xsl:text&gt;"EXTF";510;21;"Buchungsstapel";7;&lt;/xsl:text&gt;&lt;xsl:value-of select="format-dateTime($date, '[Y0001][M01][D01][H01][m01][s01][f001]')"&gt;&lt;/xsl:value-of&gt;&lt;xsl:text&gt;;;"RE";"ImixsWorkflow";"";&lt;/xsl:text&gt;&lt;xsl:value-of select="item[@name='_datev_consultant_id']/value" /&gt;&lt;xsl:text&gt;;&lt;/xsl:text&gt;&lt;xsl:value-of select="item[@name='_datev_client_id']/value" /&gt;&lt;xsl:text&gt;;&lt;/xsl:text&gt;&lt;xsl:value-of select="format-dateTime($fiscalstart, '[Y0001][M01][D01]')"&gt;&lt;/xsl:value-of&gt;&lt;xsl:text&gt;;&lt;/xsl:text&gt;&lt;!-- Sachkontennumernlaenge mandantenabhaengig - defautl = 6 --&gt;&lt;xsl:choose&gt;  &lt;xsl:when test="string-length(./item[@name='_datev_sachkontennummernlaenge']/value) &gt; 0"&gt;    &lt;xsl:value-of select="item[@name='_datev_sachkontennummernlaenge']/value" /&gt;&lt;xsl:text&gt;;&lt;/xsl:text&gt;  &lt;/xsl:when&gt;  &lt;xsl:otherwise&gt;    &lt;xsl:text&gt;6;&lt;/xsl:text&gt;  &lt;/xsl:otherwise&gt;&lt;/xsl:choose&gt;&lt;xsl:value-of select="format-dateTime($stapelstart, '[Y0001][M01][D01]')"/&gt;&lt;xsl:text&gt;;&lt;/xsl:text&gt;&lt;xsl:value-of select="format-dateTime($stapelende, '[Y0001][M01][D01]')"/&gt;&lt;xsl:text&gt;;&lt;/xsl:text&gt;&lt;xsl:text&gt;"&lt;/xsl:text&gt;&lt;xsl:value-of select="concat('Rechnungen ',format-dateTime($date, '[D01][M01]'))"/&gt;&lt;xsl:text&gt;"&lt;/xsl:text&gt;&lt;xsl:text&gt;;&lt;/xsl:text&gt;&lt;xsl:text&gt;"";1;0;0;;;;;;;;;"";""&lt;/xsl:text&gt;&lt;xsl:text&gt;&amp;#xa;&lt;/xsl:text&gt;&lt;xsl:text&gt;Umsatz (ohne Soll-/Haben-Kennzeichen);Soll-/Haben-Kennzeichen;WKZ Umsatz;Kurs;Basisumsatz;WKZ Basisumsatz;&lt;/xsl:text&gt;&lt;xsl:text&gt;Konto;Gegenkonto(ohne BU-Schlüssel);BU-Schlüssel;Belegdatum;Belegfeld 1;Belegfeld 2;Skonto;&lt;/xsl:text&gt;&lt;xsl:text&gt;Buchungstext;Postensperre;Diverse Adressnummer;Geschäftspartnerbank;Sachverhalt;Zinssperre;Beleglink;&lt;/xsl:text&gt;&lt;xsl:text&gt;Beleginfo – Art 1;Beleginfo – Inhalt 1;&lt;/xsl:text&gt;&lt;xsl:text&gt;Beleginfo – Art 2;Beleginfo – Inhalt 2;&lt;/xsl:text&gt;&lt;xsl:text&gt;Beleginfo – Art 3;Beleginfo – Inhalt 3;&lt;/xsl:text&gt;&lt;xsl:text&gt;Beleginfo – Art 4;Beleginfo – Inhalt 4;&lt;/xsl:text&gt;&lt;xsl:text&gt;Beleginfo – Art 5;Beleginfo – Inhalt 5;&lt;/xsl:text&gt;&lt;xsl:text&gt;Beleginfo – Art 6;Beleginfo – Inhalt 6;&lt;/xsl:text&gt;&lt;xsl:text&gt;Beleginfo – Art 7;Beleginfo – Inhalt 7;&lt;/xsl:text&gt;&lt;xsl:text&gt;Beleginfo – Art 8;Beleginfo – Inhalt 8;&lt;/xsl:text&gt;&lt;xsl:text&gt;KOST1 – Kostenstelle;KOST2 – Kostenstelle;KOST-Menge;EU-Mitgliedstaat u. USt-IdNr.;EU-Steuersatz;Abw. Versteuerungsart;Sachverhalt L+L;Funktionsergänzung L+L;BU 49 Hauptfunktionstyp;BU 49 Hauptfunktionsnummer;BU 49 Funktionsergänzung;&lt;/xsl:text&gt;&lt;xsl:text&gt;Zusatzinformation – Art 1;Zusatzinformation – Inhalt 1;&lt;/xsl:text&gt;&lt;xsl:text&gt;Zusatzinformation – Art 2;Zusatzinformation – Inhalt 2;&lt;/xsl:text&gt;&lt;xsl:text&gt;Zusatzinformation – Art 3;Zusatzinformation – Inhalt 3;&lt;/xsl:text&gt;&lt;xsl:text&gt;Zusatzinformation – Art 4;Zusatzinformation – Inhalt 4;&lt;/xsl:text&gt;&lt;xsl:text&gt;Zusatzinformation – Art 5;Zusatzinformation – Inhalt 5;&lt;/xsl:text&gt;&lt;xsl:text&gt;Zusatzinformation – Art 6;Zusatzinformation – Inhalt 6;&lt;/xsl:text&gt;&lt;xsl:text&gt;Zusatzinformation – Art 7;Zusatzinformation – Inhalt 7;&lt;/xsl:text&gt;&lt;xsl:text&gt;Zusatzinformation – Art 8;Zusatzinformation – Inhalt 8;&lt;/xsl:text&gt;&lt;xsl:text&gt;Zusatzinformation – Art 9;Zusatzinformation – Inhalt 9;&lt;/xsl:text&gt;&lt;xsl:text&gt;Zusatzinformation – Art 10;Zusatzinformation – Inhalt 10;&lt;/xsl:text&gt;&lt;xsl:text&gt;Zusatzinformation – Art 11;Zusatzinformation – Inhalt 11;&lt;/xsl:text&gt;&lt;xsl:text&gt;Zusatzinformation – Art 12;Zusatzinformation – Inhalt 12;&lt;/xsl:text&gt;&lt;xsl:text&gt;Zusatzinformation – Art 13;Zusatzinformation – Inhalt 13;&lt;/xsl:text&gt;&lt;xsl:text&gt;Zusatzinformation – Art 14;Zusatzinformation – Inhalt 14;&lt;/xsl:text&gt;&lt;xsl:text&gt;Zusatzinformation – Art 15;Zusatzinformation – Inhalt 15;&lt;/xsl:text&gt;&lt;xsl:text&gt;Zusatzinformation – Art 16;Zusatzinformation – Inhalt 16;&lt;/xsl:text&gt;&lt;xsl:text&gt;Zusatzinformation – Art 17;Zusatzinformation – Inhalt 17;&lt;/xsl:text&gt;&lt;xsl:text&gt;Zusatzinformation – Art 18;Zusatzinformation – Inhalt 18;&lt;/xsl:text&gt;&lt;xsl:text&gt;Zusatzinformation – Art 19;Zusatzinformation – Inhalt 19;&lt;/xsl:text&gt;&lt;xsl:text&gt;Zusatzinformation – Art 20;Zusatzinformation – Inhalt 20;&lt;/xsl:text&gt;&lt;xsl:text&gt;Stück;Gewicht;Zahlweise;Forderungsart;Veranlagungsjahr;Zugeordnete Fälligkeit;Skontotyp;Auftragsnummer;Buchungstyp;USt-Schlüssel (Anzahlungen);EU-Mitgliedstaat (Anzahlungen);Sachverhalt L+L (Anzahlungen):&lt;/xsl:text&gt;&lt;xsl:text&gt;EU-Steuersatz (Anzahlungen);Erlöskonto (Anzahlungen);Herkunft-Kz;Leerfeld;KOST-Datum;SEPA-Mandatsreferenz;Skontosperre;Gesellschaftername;Beteiligtennummer;Identifikationsnummer;Zeichnernummer;Postensperre bis;Bezeichnung SoBil-Sachverhalt;Kennzeichen SoBil-Buchung;Festschreibung;Leistungsdatum;Datum Zuord. Steuerperiode&lt;/xsl:text&gt;		&lt;xsl:text&gt;&amp;#xa;&lt;/xsl:text&gt;	&lt;/xsl:template&gt;	&lt;!-- This template builds datev body info for each invoice 	     wir nehmen jedes workitem das kein DATEV-Export ist - also invoices oder Data Export items (IW24 repimport) --&gt;	&lt;xsl:template		match="/data/document[normalize-space(item[@name = '$workflowgroup']/value) != 'DATEV-Export']"&gt;				&lt;!-- compute invoice date: if _accountingdate not defined, then the fallback is _invoicedate --&gt;		&lt;xsl:variable name="date"&gt; 			&lt;xsl:choose&gt;	         &lt;xsl:when test="string-length(item[@name='_accountingdate']/value) = 0"&gt;	           &lt;!-- Fallback... --&gt;	           &lt;xsl:value-of select="item[@name='_invoicedate']/value" /&gt;	         &lt;/xsl:when&gt;	         &lt;xsl:otherwise&gt;	           &lt;xsl:value-of select="item[@name='_accountingdate']/value" /&gt;	         &lt;/xsl:otherwise&gt;	       &lt;/xsl:choose&gt;	    &lt;/xsl:variable&gt;      		&lt;xsl:variable name="gegenkonto" select="item[@name='_kreditor_konto']/value"/&gt;		&lt;!-- &lt;xsl:variable name="subject" select="item[@name='_subject']/value"/&gt; --&gt;		&lt;xsl:variable name="subject" select="substring(item[@name='_datev_description']/value,1,59)" /&gt;		&lt;xsl:variable name="invoicenumber" select="item[@name='_invoicenumber']/value"/&gt;		&lt;!-- Geaendert 14.4.2020 - kostenstelle-1 nun auf child ebene 		&lt;xsl:variable name="costcentre1" select="item[@name='_costcentre1']/value"/&gt;		--&gt;				&lt;xsl:variable name="uniqueid" select="item[@name='$uniqueid']/value"/&gt;		&lt;xsl:for-each select="item[@name='_childitems']/value"&gt;					&lt;xsl:variable name="betrag" select="replace(./item[@name='_amount']/value, '\.', ',')"/&gt;			&lt;xsl:variable name="abs_betrag" select="replace($betrag, '-', '')"/&gt;			&lt;xsl:value-of select="$abs_betrag" /&gt;&lt;xsl:text&gt;;&lt;/xsl:text&gt;			&lt;!-- S / H  --&gt;			&lt;xsl:if test="not(starts-with($betrag, '-'))"&gt;                &lt;xsl:text&gt;S;&lt;/xsl:text&gt;			&lt;/xsl:if&gt;			&lt;xsl:if test="(starts-with($betrag, '-'))"&gt;                &lt;xsl:text&gt;H;&lt;/xsl:text&gt;			&lt;/xsl:if&gt;			&lt;xsl:text&gt;;;;;&lt;/xsl:text&gt;			&lt;xsl:value-of select="./item[@name='_konto']/value" /&gt;&lt;xsl:text&gt;;&lt;/xsl:text&gt;			&lt;xsl:value-of select="$gegenkonto" /&gt;&lt;xsl:text&gt;;&lt;/xsl:text&gt;			&lt;xsl:value-of select="./item[@name='_tax']/value" /&gt;&lt;xsl:text&gt;;&lt;/xsl:text&gt;			&lt;xsl:value-of select="format-dateTime($date, '[D01][M01]')"/&gt;&lt;xsl:text&gt;;&lt;/xsl:text&gt;			&lt;xsl:value-of select="$invoicenumber"/&gt;&lt;xsl:text&gt;;&lt;/xsl:text&gt;			&lt;xsl:text&gt;;;&lt;/xsl:text&gt;			&lt;xsl:value-of select="$subject"/&gt;&lt;xsl:text&gt;;&lt;/xsl:text&gt;			&lt;xsl:text&gt;;;;;;&lt;/xsl:text&gt;				&lt;!-- Beleglink --&gt;					&lt;xsl:text&gt;BEDI "&lt;/xsl:text&gt;&lt;xsl:value-of select="$uniqueid"/&gt;&lt;xsl:text&gt;";&lt;/xsl:text&gt;	 							&lt;xsl:text&gt;;;;;;;;;;;;;;;;;&lt;/xsl:text&gt;						&lt;!-- Geaendert 14.4.2020 - kostenstelle-1 nun auf child ebene 				&lt;xsl:value-of select="$costcentre1" /&gt;&lt;xsl:text&gt;;&lt;/xsl:text&gt;			--&gt;			&lt;xsl:value-of select="./item[@name='_costcentre1']/value" /&gt;&lt;xsl:text&gt;;&lt;/xsl:text&gt;			&lt;xsl:value-of select="./item[@name='_costcentre2']/value" /&gt;&lt;xsl:text&gt;;&lt;/xsl:text&gt;			&lt;xsl:text&gt;;;;;;;;;;;;;;;&lt;/xsl:text&gt;			&lt;xsl:text&gt;&amp;#xa;&lt;/xsl:text&gt;					&lt;/xsl:for-each&gt;	&lt;/xsl:template&gt;&lt;/xsl:stylesheet&gt;</value></item><item name="xslresource"><value xsi:type="xs:string">/office-krieger/src/reports/DATEV/datev_csv_invoices-1.7.xsl</value></item></document>