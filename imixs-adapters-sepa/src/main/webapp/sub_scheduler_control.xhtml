<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:i="http://java.sun.com/jsf/composite/imixs"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:marty="http://java.sun.com/jsf/composite/marty">


	<script type="text/javascript">
		/*<![CDATA[*/

		function updateStatustPanel(data) {
			//initUserInput($('#userselector_id'));
			if (data.status === 'success') {
				// select with wildcard operator
				$('[id$=status_panel]').imixsLayout();
			}
		}

		/*]]>*/
	</script>


	<!-- **** General info ***** -->
	<div class="imixs-form-panel">
		<h1>Timer Settings</h1>
		<h:inputTextarea required="false"
			converter="org.imixs.VectorConverter"
			style="height: 8em; width: 100%;"
			value="#{sepaController.configuration.itemList['_scheduler_definition']}">
		</h:inputTextarea>


	</div>

	<!-- **** Timer Status ***** -->
	<div class="imixs-form-panel">
		<h:panelGroup layout="block" id="timer_details"
			class="imixs-form-section">

			<h1>
				<h:outputText id="timer_status"
					value="Timer Status â‡¢ #{sepaController.configuration.item['statusMessage']}" />

				<h:panelGroup
					rendered="#{! empty sepaController.configuration.item['errormessage']}"
					class="small" style="color:red">
					<br />Error: #{sepaController.configuration.item['errormessage']}"
								</h:panelGroup>
			</h1>

			<h:panelGrid columns="2">

				<h:panelGroup layout="block" style="width:100px;">
					<h:outputLabel value="ID: " />
				</h:panelGroup>
				<h:panelGroup>
					<h:outputText
						value="#{sepaController.configuration.item['$UniqueID']}" />
				</h:panelGroup>


				<h:outputLabel value="Schedule: " />
				<h:outputText
					value="#{sepaController.configuration.item['Schedule']}" />



				<h:outputLabel value="Next Timeout: " />
				<h:panelGroup>
					<h:outputText
						value="#{sepaController.configuration.item['nextTimeout']}"
						rendered="#{! empty sepaController.configuration.item['nextTimeout']}">
						<f:convertDateTime timeZone="#{message.timeZone}" type="both"
							pattern="#{message.dateTimePattern}" />


					</h:outputText>
					<h:outputText value=" " />
				</h:panelGroup>

				<h:outputLabel value="TimeRemaining: " />
				<h:outputText
					value="#{sepaController.millisToShortDHMS(sepaController.configuration.item['timeRemaining'])}" />

				<h:outputLabel value="Last run: " />
				<h:outputText
					value="#{sepaController.configuration.item['datLastRun']}">
					<f:convertDateTime timeZone="#{message.timeZone}" type="both"
						pattern="#{message.dateTimePatternShort}" />
				</h:outputText>

				<h:outputLabel value="Log: " />
				<h:panelGroup>
					<pre>
									<h:outputText
							value="#{sepaController.configuration.item['_scheduler_log']}" />
								</pre>
				</h:panelGroup>

			</h:panelGrid>

		</h:panelGroup>

		<hr />
		<!-- Timer Actions -->
		<h:commandButton value="#{message.refresh}"
			actionListener="#{sepaController.refresh}">
			<f:ajax render="timer_details timer_status" />
		</h:commandButton>


		<h:commandButton actionListener="#{sepaController.startScheduler}"
			value="start">
		</h:commandButton>
		<h:commandButton actionListener="#{sepaController.stopScheduler}"
			value="stop">
		</h:commandButton>
		<h:commandButton actionListener="#{sepaController.restartScheduler}"
			value="restart">
		</h:commandButton>
		<hr />


	</div>
</ui:composition>